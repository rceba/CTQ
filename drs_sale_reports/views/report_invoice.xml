<odoo>
    <template id="report_invoice_document" inherit_id="account.report_invoice_document">
        <xpath expr="//div[@name='address_same_as_shipping']" position="attributes">
            <attribute name="t-if">1 == 0</attribute>
        </xpath>
        <xpath expr="//div[hasclass('clearfix')]" position="attributes">
            <attribute name="class">clearfix</attribute>
        </xpath>
        <xpath expr="//div[hasclass('clearfix')]//h2//span[3]" position="replace">
            <span t-if="o.move_type == 'out_invoice' and o.state == 'posted'">
                <span>Invoice No. </span>
            </span>
        </xpath>
        <xpath expr="//div[@id='informations']//div[@name='invoice_date']//t[1]" position="replace">
            <t t-if="o.move_type == 'out_invoice'">
                <strong>Invoice date:</strong>
            </t>
        </xpath>
        <xpath expr="//div[@id='informations']//div[@name='invoice_date']//span" position="replace">
            <span t-field="o.invoice_date" t-options='{"format": "dd/MMMM/yyyy"}'/>
        </xpath>
        <xpath expr="//div[@id='informations']//div[@name='due_date']//span" position="replace">
            <span t-field="o.invoice_date_due" t-options='{"format": "dd/MMMM/yyyy"}'/>
        </xpath>
        <xpath expr="//div[@id='informations']//div[@name='due_date']//strong" position="replace">
            <strong><span>Due Date:</span></strong>
        </xpath>
        <xpath expr="//div[@id='informations']//div[@name='reference']" position="replace">
            <div t-attf-class="#{'col-auto col-3 mw-100' if report_type != 'html' else 'col'} mb-2" t-if="o.ref" name="reference"></div>
        </xpath>
        <xpath expr="//div[@id='informations']//div[@name='origin']" position="replace">
            <div t-attf-class="#{'col-auto col-3 mw-100' if report_type != 'html' else 'col'} mb-2" t-if="o.invoice_origin" name="origin"></div>
        </xpath>
        <xpath expr="//table" position="before">
            <div class="row" style="margin-bottom:0px">
				<div class="col-6">
					<span>
						<p>
							<b>Bill to:</b>
						</p>
					</span>
				</div>
				<div class="col-6">
					<span>
						<p>
							<b>Deliver to:</b>
						</p>
					</span>
				</div>
			</div>
			<div class="row address">
				<div class="col-5">
					<div t-field="o.partner_shipping_id" t-options-widget="'contact'"/>
                </div>
				<div class="col-5 offset-1">
					<div t-field="o.partner_shipping_id" t-options-widget="'contact'"/>
                </div>
			</div>
            <div id="informations_extra" class="row mt-3 mb-1">
                <div class="col-3 mw-100 mb-2">
                    <strong><span>Payment Way:</span></strong><br/>
                    <span t-out="o.l10n_mx_edi_payment_method_id.display_name"/>
                </div>
                <div class="col-3 mw-100 mb-2">
                    <strong><span>Usage:</span></strong><br/>
                    <span t-out="dict(o.fields_get(allfields=['l10n_mx_edi_usage'])['l10n_mx_edi_usage']['selection'])[o.l10n_mx_edi_usage]"/>
                </div>
                <div class="col-3 mw-100 mb-2">
                    <strong><span>Payment terms:</span></strong><br/>
                    <span t-field="o.invoice_payment_term_id.display_name"/>
                </div>
                <div class="col-3 mw-100 mb-2">
                    <strong><span>Payment Method:</span></strong><br/>
                    <span t-field="o.l10n_mx_edi_payment_policy"/>
                </div>
            </div>
        </xpath>
        <xpath expr="//table" position="before">
            <t t-set="order_line_count" t-value="1"/>
        </xpath>
        <xpath expr="//table//tbody//t[@t-foreach='lines']" position="inside">
            <t t-if="line.display_type == 'product'">
                <t t-set="order_line_count" t-value="order_line_count + 1"/>
            </t>
        </xpath>
        <xpath expr="//table//thead//th[@name='th_description']" position="before">
            <th name="line_number" class="text-center"><strong>#</strong></th>
        </xpath>
        <xpath expr="//table//tbody//td[@name='account_invoice_line_name']" position="before">
            <td name="line_number" class="text-center">
                <span t-out="order_line_count"/>
            </td>
        </xpath>
        <xpath expr="//table//thead//th[@name='th_description']" position="replace">
            <th name="th_description">
                <strong>Product</strong>
            </th>
        </xpath>
        <xpath expr="//table//tbody//td[@name='account_invoice_line_name']/span" position="replace">
            <span t-field="line.product_id.display_name"/>
        </xpath>
        <xpath expr="//table//thead//th[@name='th_description']" position="after">
            <th name="th_codigo_sat">
                <strong>Code SAT</strong>
            </th>
            <th name="th_description">
                <strong>Description</strong>
            </th>
            <th name="th_num_pedimento">
                <strong>Request number</strong>
            </th>
        </xpath>
        <xpath expr="//table//tbody//td[@name='account_invoice_line_name']" position="after">
            <td id="line_code_sat">
                <span t-field="line.product_id.unspsc_code_id.code"/>
            </td>
            <td id="line_description">
                <span t-raw="line.name" t-options="{'widget': 'html'}"/>
                <t t-set="custom_numbers" t-value="line._l10n_mx_edi_get_custom_numbers()"/>
                <t t-if="custom_numbers">
                    <br/>Customs:
                    <ul>
                        <t t-foreach="custom_numbers" t-as="custom_number">
                            <li>
                                <span t-out="custom_number"/>
                            </li>
                        </t>
                    </ul>
                </t>
            </td>
            <td id="td_num_pedimento">
                <span t-esc="o.x_studio_customs_number"/>
            </td>
        </xpath>
        <xpath expr="//table//th[@name='th_quantity']/span" position="replace">
            <strong>Qty</strong>
        </xpath>
        <xpath expr="//table//tbody//td[@name='td_quantity']//span[2]" position="replace">
        </xpath>
        <xpath expr="//table//thead//th[@name='th_quantity']" position="after">
            <th name="th_uom" class="text-center"><strong>UOM</strong></th>
        </xpath>
        <xpath expr="//table//tbody//td[@name='td_quantity']" position="after">
            <td class="text-center">
                <span t-field="line.product_uom_id"></span>
            </td>
        </xpath>
        <xpath expr="//table//thead//th[@name='th_taxes']" position="replace">
        </xpath>
        <xpath expr="//table//thead//th[@name='th_priceunit']//span" position="replace">
            <strong>Unit Price</strong>
        </xpath>
        <xpath expr="//table//tbody//td[@name='td_taxes']" position="replace">
        </xpath>
        <xpath expr="//table//thead//th[@name='th_subtotal']//span" position="replace">
            <strong>subtotal</strong>
        </xpath>
        <xpath expr="//p[@name='payment_communication']//.." position="after">
            <div class="row mb-2">
                <div class="col-3">
                    <span><strong>Currency:</strong><br/></span>
                    <span t-field="o.currency_id.display_name"/>
                </div>
                <div class="col-6">
                    <span><strong>Payment Communication:</strong><br/></span>
                    <span t-field="o.payment_reference"/>
                </div>
                <div class="col-3">
                    <span><strong>Exchange rate:</strong><br/></span>
                    <span t-field="o.currency_id.inverse_rate"/>
                </div>
            </div>
        </xpath>
        <xpath expr="//p[@name='payment_communication']//.." position="replace">
        </xpath>
    </template>
    <template id="report_invoice_document_l10n_mx_edi" inherit_id="l10n_mx_edi.report_invoice_document">
        <xpath expr="//div[@name='l10n_mx_edi_payment_method_details']" position="replace">
            <div t-att-class="o_grid_layout" name="l10n_mx_edi_payment_method_details"></div>
        </xpath>
        <xpath expr="//t[@name='l10n_mx_edi_condition_display_usage']//div" position="replace">
        </xpath>
        <xpath expr="//div[@name='l10n_mx_edi_payment_way_details']" position="replace">
        </xpath>
        <xpath expr="//div[@name='l10n_mx_edi_bank_account_details']" position="replace">
        </xpath>
        <xpath expr="//th[@name='l10n_mx_edi_product_code_header']" position="replace"></xpath>
        <xpath expr="//td[@name='l10n_mx_edi_product_code_cell']" position="replace"></xpath>
        <xpath expr="//table[@name='invoice_line_table']//th[@name='th_discount']/following-sibling::th[1]" position="replace">
        </xpath>
        <xpath expr="//td[@name='l10n_mx_edi_unit_code_header']" position="replace"></xpath>
    </template>

    <template id="report_invoice_document_l10n_mx_edi_extended" inherit_id="l10n_mx_edi_extended.report_invoice_document">
        <xpath expr="//t[@t-if='custom_numbers']" position="replace">
        </xpath>
    </template>
</odoo>